# 生产日志方案

### 日志生命周期简介

1. 生产日志记录在磁盘中（暂时不使用内网传输日志的方式，防止内网连接中断导致无法记录日志）
2. 日志收集程序（自制/腾讯云现有方案）备份到 腾讯云的文件存储/归档中，超过一定时间的日志删除
3. 通过 `filebeat` 之类的日志采集程序，采集日志到 `logstatash` 中
4.  `logstatsh` 增加相应的字段，传递到 `es` 
5. `grafana` 连接 `es` 展示各项报表



### 日志生产

生产服务直接生成日志，根据时间记录到磁盘的不同文件中，推荐使用 [logrus](https://github.com/sirupsen/logrus)  或者性能更高的 [uber-go/zap](https://github.com/uber-go/zap)



### 日志备份

使用自制服务或使用腾讯云现有方案（需要咨询腾讯云客服是否有现成的工具）备份到腾讯云的 文件存储/归档中，腾讯云有个 `日志服务` 提供了整套的日志处理方案，但是截止 2020-01-20 还在内测中，后续可以跟进调研下

- 腾讯云下的日志备份方案
  - 文件存储
  - 文件归档
  - 日志服务（内测中）

### 日志传递到统计 - todo - 暂时没有实际环境测试，后续追加

- filebeat
- logstatsh
- es
- grafana

